{% extends 'base.html' %}{% load i18n %} {% load readmore el_pagination_tags staticfiles %}
{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/timeline_app.css' %}" />
<style>
	 .main-page-only{
		display:none;
	}

	@media (min-width: 767px) { 
		.box {
		    width: 200px;
		    margin-left: 0px !important; 
		}

		.content-right {
		    float: initial !important;
		}

		.box {
		    width: 100% !important;
		    margin-left: 0px !important;
		}
	}


</style>
{% endblock %}

{% block subheader %}
   {% include "subheader.html"%}
{% endblock subheader %}
{% block main %}
    <div class="col-lg-1"> 
	<nav class="navbar navbar-sidemenu " style="width:100%;">
		<div class="container-fluid">

			<div class="navbar-header  side-header-nav">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#SideSubNavbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				</button>
			
				<div class="navbar-brand " style="padding-left:32px; " >
					 Tags
				</div>
			</div>
			<div id="SideSubNavbar" class="navbar-collapse collapse  small-menu" style="width:100%;">  
				<div class="content-left">
					<a href="{% url 'item_list' category_slug  "all" %}?usertype={{request.GET.usertype }}"
					{% if topic_slug == 'all' %} class="selected-link"{% endif %}>{% trans "All Topics" %}</a><br>

					{% for topic in top_topics %}
					<a href="{% url 'item_list' category_slug  topic.slug %}?usertype={{request.GET.usertype }}" title="Posts: {{ topic.topic_count }}"
					{% if topic.slug == topic_slug %}class="selected-link"{% endif %} style="margin-right: 5px;">{{ topic.name }}</a>
					{% endfor %}
				</div>
			</div>
		</div>
	</nav>
</div>
<div class="col-lg-9">
    {% include 'timeline/timelineitem_list.html' %}
</div>
{% endblock main %}
{% block right %}

<div class="col-lg-2">
<div class="content-right">
    <div class="box">
        <div class="header">{{ view_user.profile.get_display_name }}</div>
        <div class="box-content">
            <div class="row">{% trans "Member since" %}: {{view_user.profile.create_date |date:"M d, Y"}}</div>
            <div class="row">{% trans "Posts" %}: {{post_count}} </div>
            <div class="row">{% trans "Following" %} : {{following_count}}</div>
            <div id="follower_count" class="row"> {% trans "Followers" %}: {{follower_count}}</div>
        </div>
    </div>
 {% if user.is_authenticated %}
 {% if user.id != view_user.id %}
    <a href="{% url 'user_message_list_detail' view_user.username %}">
    <div class="button" style="width:98px;text-align:center;">
        {% trans "Send a Note" %}
    </div>
    </a>

    <form id="unfollow" action="{% url 'user_unfollow' view_user.pk %}">
        {% csrf_token %}
        <div id="unfollow_button" class="button" style="width:98px;text-align:center;">
            {% trans "Unfollow" %}</div>
    </form>

    <form id="follow" action="{% url 'user_follow' view_user.pk %}">
        {% csrf_token %}
        <div id="follow_button" class="button" style="width:98px;text-align:center;">
            {% trans "Follow" %}</div>
    </form>
{% endif %}
{% else %}
    <div class="button" style="width:98px;text-align:center;" onClick="window.location = '{%  url 'userena_signin'  %}'">
        {% trans "Send a Note" %}
    </div>
    <div id="follow_button_login" class="button" style="width:98px;text-align:center;" onClick="window.location = '{%  url 'userena_signin'  %}'">
        {% trans "Follow" %}</div>
{% endif %}


    <div class="clear-both"></div>
</div>
</div>

{% endblock right %} {% block extra_js %}
	{% include 'timeline/timeline_js.html' %}
<script type="text/javascript">
    $(function() {
        var hasFollowed = "{{ has_followed }}";
        if (hasFollowed.toUpperCase() === 'TRUE') {
            $('#unfollow').show();
            $('#follow').hide();
        } else {
            $('#unfollow').hide();
            $('#follow').show();
        }
        var authenticated = "{{ has_followed }}";

        $('#follow_button').click(function() {
            var form = $('#follow');
            $.ajax({
                type: 'POST',
                url: form.attr('action'),
                data: form.serialize(),
                success: function(data) {
                    $('#unfollow').show();
                    $('#follow').hide();
                    $('#follower_count').html( 'Followers: ' +data.follower_count);
                }
            });
        });

        $('#unfollow_button').click(function() {
            var form = $('#unfollow');
            $.ajax({
                type: 'POST',
                url: form.attr('action'),
                data: form.serialize(),
                success: function(data) {
                    $('#unfollow').hide();
                    $('#follow').show();
                    $('#follower_count').html( 'Followers: ' +data.follower_count);
                }
            });
        });
    });
</script>

{% endblock %}
